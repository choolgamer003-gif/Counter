<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Counter</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
  }
  #count {
    font-size: 40px;
    margin-bottom: 5px;
  }
  #legend {
    font-size: 16px;
    margin-bottom: 20px;
  }
  #icons {
    font-size: 32px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  .icon {
    display: inline-block;
  }
  #resetBtn {
    display: none; /* hidden */
  }
</style>
</head>
<body>

<div id="count">0</div>
<div id="legend">*Icons = 100,000 abortions*</div>
<div id="icons"></div>
<button id="resetBtn">Reset Counter</button>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-database.js"></script>

<script>
  // ---------- CONFIG ----------
  const firebaseConfig = {
    apiKey: "AIzaSyDeb7DFUNOX8PHCVqoQJ--rWy-yOxXf9KU",
    authDomain: "counter-f9760.firebaseapp.com",
    databaseURL: "https://counter-f9760-default-rtdb.firebaseio.com",
    projectId: "counter-f9760",
    storageBucket: "counter-f9760.appspot.com",
    messagingSenderId: "58667928978",
    appId: "1:58667928978:web:7a6b693dd373b2fbbf854b",
    measurementId: "G-GTG0KJT0LX"
  };

  // ---------- INITIALIZE ----------
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const totalRef = db.ref("total");
  const START_TOTAL = 116576241;

  const countEl = document.getElementById("count");
  const iconsEl = document.getElementById("icons");
  const resetBtn = document.getElementById("resetBtn");

  const decadeEmojis = [
    'ðŸ”´','ðŸŸ ','ðŸŸ¡','ðŸŸ¢','ðŸ”µ','ðŸŸ£'
  ];

  // ---------- FUNCTIONS ----------
  function renderIcons(total) {
    iconsEl.innerHTML = "";
    let iconsCount = Math.floor(total / 100000);
    for (let i = 0; i < iconsCount; i++) {
      const icon = document.createElement("span");
      icon.className = "icon";
      icon.textContent = decadeEmojis[Math.floor(i / 10) % decadeEmojis.length];
      iconsEl.appendChild(icon);
    }
  }

  function incrementTotal() {
    totalRef.transaction(current => {
      if (typeof current === "number") return current + 1;
      else return START_TOTAL;
    });
  }

  // Ensure total exists
  totalRef.once("value", snapshot => {
    if (!snapshot.exists()) totalRef.set(START_TOTAL);
  });

  // Listen for changes
  totalRef.on("value", snapshot => {
    const total = snapshot.val() || START_TOTAL;
    countEl.textContent = total.toLocaleString();
    renderIcons(total);
  });

  // Auto-increment 1 every 10â€“30 sec
  function randomIncrement() {
    setTimeout(() => {
      incrementTotal();
      randomIncrement();
    }, 10000 + Math.random() * 20000);
  }
  randomIncrement();

  // Hidden reset
  resetBtn.addEventListener("click", () => {
    totalRef.set(START_TOTAL);
  });
</script>

</body>
</html>
